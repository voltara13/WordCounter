# Word Counter

## Архитектура
### 0. Приложение не поддерживает русские символы :(
### 1. В основе лежит паттерн MVC
- Model: Представляет собой данные. В текущем случае за данные можно принять модель гистограммы, над которой работает WordCounterController.
- View: Отображает интерфейс. В QML файлах реализован интерфейс пользователя, который отображает результаты анализа и предоставляет элементы управления для взаимодействия с моделью.
- Controller: Обрабатывает ввод пользователя и обновляет модель и представление соответственно. WordCounterController отвечает за создание, запуск, приостановку и полную остановку потока работника (счётчика).
### 2. WordCounterController
- Класс WordCounterController экспортируется в пространство имен testapp, что позволяет его использовать в QML. В QML этот класс используется для управления процессом подсчета частоты слов, включая выбор файла, запуск, паузу и отмену процесса, а также обновление пользовательского интерфейса на основе полученных данных.
Использование многопоточности позволяет избежать блокировки графического интерфейса во время длительных операций с файлами. События изменения состояния и данных передаются между QML и C++ через механизм сигналов и слотов Qt.
    #### Основные компоненты
- Конструктор и деструктор: Конструктор инициализирует объект, а деструктор вызывает метод abort() перед уничтожением объекта, чтобы корректно завершить работу, если она еще идет.
- Методы управления состоянием: Методы start(), pause(), и abort() позволяют управлять выполнением процесса подсчета. Они изменяют внутренние флаги состояния и могут инициировать или прервать работу рабочего потока.
- Работа с файлом: Метод SetFilePath() устанавливает путь к файлу для анализа и автоматически вызывает abort() для предотвращения повторного использования старого пути без явного вызова start().
- Использование рабочего потока: Рабочий поток создается и управляется через метод SetIsCanceled(). Если процесс отменен, рабочий поток прерывается. При необходимости создается новый рабочий поток для продолжения работы.
- Обработка результатов: После завершения работы рабочего потока, результаты передаются обратно в главный поток через слот SetHistogram().
### 3. WorkerThread
- Класс WorkerThread представляет собой реализацию рабочего потока для асинхронного подсчета частоты слов в текстовом файле. Этот класс наследуется от QThread и использует многопоточность для обработки данных без блокирования главного потока приложения.
    #### Основные компоненты
- Конструктор и деструктор: Конструктор инициализирует объект, открывает файл для чтения и выбрасывает исключение, если файл не может быть открыт, деструктор закрывает файл, если он был открыт.
- Метод SetIsPaused() позволяет приостанавливать и возобновлять выполнение потока. Используется мьютекс для синхронизации доступа к переменной _isPaused и условная переменная _pauseCondition для блокировки потока во время паузы.
- Метод run() содержит основную логику выполнения потока. Он читает данные из файла, обрабатывает их порциями, используя пул потоков (QThreadPool) для параллельного подсчета частоты слов в каждой порции данных.
- Используется QTextStream для чтения файла и QRegularExpression для разделения текста на слова.
- Результаты подсчета частоты слов собираются из всех QFuture и объединяются в один QVariantMap.
- После завершения обработки каждой порции данных, если поток не был прерван, эмитируется сигнал wordsCountsReady с полученным словарем частот слов.

## Принцип работы

1. Пользователь выбирает текстовый документ.
2. Нажимает "Start".
3. Приложение начинает обработывать файл, строит гистограмму в реальном времени. Если пользователь что-либо изменит в файле - это образится на гистограмме.
4. Пользователь может как приостановить обработку, так и завершить её полностью.
